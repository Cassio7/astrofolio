---
import { Button } from "@/components/button";

import { ChevronUp } from "lucide-react";
---

<Button
  id="back-to-top"
  className="fixed right-4 bottom-[4rem] z-50 cursor-pointer rounded-full lg:left-[calc(100vw/2+400px)]"
  size="icon"
>
  <ChevronUp />
</Button>

<script>
  function handleScroll() {
    const button = document.querySelector("#back-to-top");
    if (!button) return;

    if (window.scrollY < window.innerHeight) {
      button.classList.add("scale-0");
    } else {
      button.classList.remove("scale-0");
    }
  }

  function backToTop() {
    const button = document.querySelector("#back-to-top");
    if (!button) return;

    button.addEventListener("click", () => {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE, and Opera
    });

    // Check scroll position on page load and scroll events
    handleScroll();
    window.addEventListener("scroll", handleScroll);
  }

  backToTop();

  /* Go to page start after page swap */
  document.addEventListener("astro:after-swap", () => {
    window.scrollTo({ left: 0, top: 0, behavior: "instant" });
    handleScroll(); // Ensure the button state updates after a page swap
  });
</script>
